{% extends 'bandongo/frontend_base.html' %}
{% load staticfiles %}

 {% block script %}
 <!-- Latest compiled and minified CSS -->




    <link rel="stylesheet" href="{%static 'bootstrap/css/bootstrap-select.min.css' %}">
    <style>
    
    table{ border-collapse: separate; }
    table td { border-spacing: 1em; }

    #clockdiv{
    font-family: sans-serif;
    color: #fff;
    display: inline-block;
    font-weight: 100;
    text-align: center;
    font-size: 30px;
    }
    
    #clockdiv > div{
    padding: 10px;
    border-radius: 3px;
    background: #00BF96;
    display: inline-block;
    }
    
    #clockdiv div > span{
    padding: 15px;
    border-radius: 3px;
    background: #00816A;
    display: inline-block;
    }
    
    .smalltext{
    padding-top: 5px;
    font-size: 16px;
    }
    </style>
  <!--<script src="{% static 'front_bootstrap/js/jquery.min.js' %}"></script>-->
  <!--<script src="{% static 'front_bootstrap/js/3.3.4/bootstrap.min.js' %}"></script>-->
    <script src="{% static 'bootstrap/js/bootstrap-select.min.js' %}"></script>
    <script>
        function orderForm() {
            var foodlen = document.forms["orderform"]["food-len"].value;
            var lock = 0;
            
            
            var drinkname = document.forms["orderform"]["drink-name"].value;
            var drinkprice = document.forms["orderform"]["drink-price"].value;
            
            var strindex;
            var foodnum;
            
            for (var i = 1; i <= foodlen; i++) {
                strindex = i.toString();
                foodnum = document.forms["orderform"]["food-num"+strindex].value;
               
                if(foodnum != "0"){
                    lock = 1;
                }
            }
            
            if (drinkname == "" && lock == 0) {
                bootbox.alert("請選擇餐點");
                return false;
            }
            if (drinkname != "" && drinkprice ==""){
                bootbox.alert("請輸入飲料價格");
                return false;
            }
        }
        
    </script>
    <script type="text/javascript">
    function codeAddress() {
        var member_saving = "{{de_member.saving}}";
        if(member_saving < 100){
            bootbox.alert({
                title:"<h3 style='color:#0C182D; font-weight:bold;'>餘額不足通知</h3>",
                message: "<h4>您的帳戶餘額不足 <font style='color:red; font-weight:bold;'>壹佰</font> 元，請儘速儲值</h4>",
                backdrop: true
                
        });
        }
        
    }
    window.onload = codeAddress;
    </script>
{% endblock %}


{% block subcontent %}
    
    
    
    {% if finish_order %}
        <h1>訂餐完成！</h1>
    
    {% elif schedule_name %}
        
<!--<div id="clockdiv">-->
<!--    <div>-->
<!--    <span>{% if due_date %}-->
<!--    {{due_date}}-->
<!--    {% endif %}</span>-->
<!--    <div class="smalltext">截止時間-->
<!--    </div>-->
<!--    </div>-->
<!--    <div>-->
<!--    <span class="hours"></span>-->
<!--    <div class="smalltext">Hours</div>-->
<!--    </div>-->
<!--    <div>-->
<!--    <span class="minutes"></span>-->
<!--    <div class="smalltext">Minutes</div>-->
<!--    </div>-->
<!--    <div>-->
<!--    <span class="seconds"></span>-->
<!--    <div class="smalltext">Seconds</div>-->
<!--    </div>-->
<!--</div>-->
        {%if due_date %}
            <h3 style="color:#F74906;">截止時間：{{due_date | date:'m/d H:i'}}</h2>
            <br>
        {% endif %}
           
        <form name="orderform" onsubmit="return orderForm()" action="" method="POST" class="post-form" accept-charset="utf-8">
            {% if list_food.0.foodShop != "休" %}
                
                <table class="table">
                    <thead>
                    <!--<tr>-->
                    <!--    <th colspan="4" style="background-color:#E1E1E1;"></th>-->
                    <!--</tr>-->
                    <tr style="background-color:#f9a34d; color:#FFFFFF;">
                        <th class="col-sm-3" style="font-weight:bold;"><h4>本日熱門</h4></th>
                        
                        <th class="col-sm-5" ><h4>品項</h4></th>
                        <th class="col-sm-4" ><h4>累積數量</h4></th>
                    
                    </tr>
                    </thead>
                    <tbody>
                    {% if top3 %}
                        {% for top3 in top3 %}
                        <tr>
                            <td><img src="/static/pic/medal/medal{{forloop.counter}}.png" class="img-responsive img-circle col-sm-3"  width="40" height="50"></td>
                            <td>{{top3.foodName__name}}</td>
                            <td>{{top3.s_sum}}</td>
                        </tr>
                        {% endfor %}
                    {% else %}
                        <tr><th colspan="3"><h3>正在吸取日月天地精華中...</h3></th></tr>
                    {% endif %}
                    </tbody>
                </table>
                
                
                <table class="table">
                
                <tr style="background-color:#EDEDE4;">
                    <th class="col-sm-3" colspan="2" ><h4>{{list_food.0.foodShop}}</h4></th>
                    <th class="col-sm-5" colspan="1" ><h4>價格</h4></th>
                    <th class="col-sm-4" colspan="1" ><h4>數量</h4></th>
                    
                </tr>
                <input type="hidden" name="food-len" value="{{ list_food|length }}"/>
                <input type="hidden" name="schedule" value="{{schedule_name}}"/>
                {% for foods in list_food %}
                    <tr>
                        <td><input type="hidden" name="food-name{{ forloop.counter }}" value="{{ foods.name }}"/>{{foods.name}}</td>
                        <td>
                        {% if foods.pic %}
                          <img src="/{{foods.pic}}" class="img-responsive img-circle col-xs-12"  width="400" height="200"> 
                        {% else %}
                          <p> </p>
                        {% endif%}
                        </td>
                        <td>{{foods.price}}</td>
                        <td>
                            <select name="food-num{{ forloop.counter }}" class ="selectpicker show-tick form-control"/>
                            <option value="0">0</option>
                            <option value="1">1</option>
                          	<option value="2">2</option>
                          	<option value="3">3</option>
                          	<option value="4">4</option>
                            <option value="5">5</option>
                          	</select>
                        </td>
                        
                    </tr>
                    
                {% endfor %}
                
                </table>
            {% endif %}
            
            {% if pic_beverage.0.name != "休" %}
                <table class = "table">
                    <tr>
                        <th colspan="4" style="background-color:#E1E1E1;"><h4>{{pic_beverage.0.name}}</h4></th>
                    </tr>
                    <tr>
                        <th colspan="4">
                            <br>
                            <div class="container">
                                <div class="row">
                                    <div class="col-lg-1 col-md-1"></div>
                                    <div class="col-lg-10 col-md-10 col-sm-12 col-xs-12">
                                        <img src="/{{pic_beverage.0.pic}}" class="img-responsive img-center" style="max-width: 100%; 
        max-height: 100%; display:block; margin:auto;"> 
                                    </div>
                                    <div class="col-lg-1 col-md-1"></div>
                                </div>
                            </div>
                        </th>
                    </tr>
                    <tr>
                        <td>
                            <!--<div class="form-group">-->
                                <label for="drink-name">喝點什麼</label>
                                <input type = "text" class="form-control" id="drink-name" name="drink-name" placeholder="飲料名稱">
                                
                                <label for="sugar">甜度</label>
                                <select class="form-control" id="sugar" name="sugar">
                                <option value="無糖">無糖</option>
                                <option value="微糖">微糖</option>
                                <option value="半糖">半糖</option>
                                <option value="少糖">少糖</option>
                                <option value="正常甜">正常甜</option>
                                </select>
                                
                                <label for="ice">冰塊</label>
                                <select class="form-control" id="ice" name="ice">
                                <option value="去冰">去冰</option>
                                <option value="少冰">少冰</option>
                                <option value="微冰">微冰</option>
                                <option value="常溫">常溫</option>
                                <option value="正常冰">正常冰</option>
                                <option value="熱的">熱的</option>
                                </select>
                                
                                <label for="drink-comment">備註</label>
                                <input type = "text" class="form-control" id="drink-comment" name="drink-comment" placeholder="加珍珠">
                                
                                <label for="drink-price">金額</label>
                                <input type = "number" class="form-control" min="0" max="100" id="drink-price" name="drink-price" placeholder="50">
                            <!--</div>-->
                            
                    
                 
            {% else %}
                <input type="hidden" name="drink-name" value=""/>
                
            {% endif %}
                    <br>
                    <button type="submit" class="btn btn-default">送出</button>
                    </td>
                    </tr>
                </table>   
        </form>
    {% else %}
        <h2>統計截止，不便之處請見諒</h2>
    {% endif %}
    



{% endblock %}

{% block script2 %}
<script>
function getTimeRemaining(endtime) {
  var t = Date.parse(endtime) - Date.parse(new Date());
  var seconds = Math.floor((t / 1000) % 60);
  var minutes = Math.floor((t / 1000 / 60) % 60);
  var hours = Math.floor((t / (1000 * 60 * 60)) % 24);
//   var days = Math.floor(t / (1000 * 60 * 60 * 24));
  return {
    'total': t,
    // 'days': days,
    'hours': hours,
    'minutes': minutes,
    'seconds': seconds
  };
}

function initializeClock(id, endtime) {
  var clock = document.getElementById(id);
//   var daysSpan = clock.querySelector('.days');
  var hoursSpan = clock.querySelector('.hours');
  var minutesSpan = clock.querySelector('.minutes');
  var secondsSpan = clock.querySelector('.seconds');

  function updateClock() {
    var t = getTimeRemaining(endtime);

    // daysSpan.innerHTML = t.days;
    hoursSpan.innerHTML = ('0' + t.hours).slice(-2);
    minutesSpan.innerHTML = ('0' + t.minutes).slice(-2);
    secondsSpan.innerHTML = ('0' + t.seconds).slice(-2);

    if (t.total <= 0) {
      clearInterval(timeinterval);
    }
  }

  updateClock();
  var timeinterval = setInterval(updateClock, 1000);
}

// var deadline = new Date(Date.parse(new Date()) + 15 * 24 * 60 * 60 * 1000);
var duedate = "{{ due_date }}";

initializeClock('clockdiv', duedate);
</script>






{% endblock %}